function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}define("local_coursegoals/coursegoals",["exports","core_form/modalform","core/str","core/notification"],(function(_exports,_modalform,_str,Notification){var obj;function _getRequireWildcardCache(nodeInterop){if("function"!=typeof WeakMap)return null;var cacheBabelInterop=new WeakMap,cacheNodeInterop=new WeakMap;return(_getRequireWildcardCache=function(nodeInterop){return nodeInterop?cacheNodeInterop:cacheBabelInterop})(nodeInterop)}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.setupTaskModalForm=_exports.setupModals=_exports.initCourseGoalsTab=void 0,_modalform=(obj=_modalform)&&obj.__esModule?obj:{default:obj},Notification=function(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule)return obj;if(null===obj||"object"!==_typeof(obj)&&"function"!=typeof obj)return{default:obj};var cache=_getRequireWildcardCache(nodeInterop);if(cache&&cache.has(obj))return cache.get(obj);var newObj={},hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj)if("default"!==key&&Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;desc&&(desc.get||desc.set)?Object.defineProperty(newObj,key,desc):newObj[key]=obj[key]}newObj.default=obj,cache&&cache.set(obj,newObj);return newObj}(Notification);var SELECTORS_COURSEGOALS_TAB_ID="#cg_goals_tab",SELECTORS_DETAILS_ID="cg_details_maintab",SELECTORS_TASK_CHECKBOX_CLASS=".cg-taskcb",SELECTORS_TASK_DETAILS_ACTIVE="data-td-active";_exports.initCourseGoalsTab=function(parentelement){var appendorder=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"last";try{var cg_tab=document.querySelector(SELECTORS_COURSEGOALS_TAB_ID),cg_parentnodes=parentelement.split(",");for(var i in cg_parentnodes){var cg_pageheader=document.querySelector(cg_parentnodes[i]);if(cg_pageheader){"first"===appendorder?cg_pageheader.prepend(cg_tab):cg_pageheader.appendChild(cg_tab);break}}var cg_details_id=SELECTORS_DETAILS_ID,cg_details_node=document.getElementById(cg_details_id),cg_localDetailsAreOpen=window.localStorage.getItem("details-"+cg_details_id);"true"!=cg_localDetailsAreOpen&&null!=cg_localDetailsAreOpen||cg_details_node.setAttribute("open","true"),cg_tab.style.display="block",cg_details_node.addEventListener("toggle",(function(e){var isOpen=event.target.getAttribute("open");window.localStorage.setItem("details-"+cg_details_id,"string"==typeof isOpen?"true":"false")})),document.querySelectorAll(SELECTORS_TASK_CHECKBOX_CLASS).forEach((function(cbdiv){var taskdetailsdiv=document.querySelector('[data-taskref="'+cbdiv.dataset.taskid+'"]');cbdiv.addEventListener("mouseenter",(function(e){var activetaskdetails=document.querySelector("["+SELECTORS_TASK_DETAILS_ACTIVE+'="active"]');activetaskdetails&&(activetaskdetails.style.display="none",activetaskdetails.removeAttribute(SELECTORS_TASK_DETAILS_ACTIVE)),taskdetailsdiv.style.display="block",taskdetailsdiv.setAttribute(SELECTORS_TASK_DETAILS_ACTIVE,"active")}))}))}catch(ignore){}};_exports.setupTaskModalForm=function(elementSelector,formClass){document.querySelectorAll(elementSelector).forEach((function(element){element.addEventListener("click",(function(e){e.preventDefault();var action=e.target.getAttribute("data-action"),title=this.getAttribute("data-title")||this.innerHTML,coursegoalid=this.getAttribute("data-coursegoalid"),taskid=this.getAttribute("data-taskid"),form=new _modalform.default({formClass:formClass,args:{taskid:taskid,coursegoalid:coursegoalid,action:action},modalConfig:{title:title,large:!0},saveButtonText:title,returnFocus:e.target});form.addEventListener(form.events.FORM_SUBMITTED,(function(event){event.detail.result?(event.detail.returnaction,event.detail.redirecturl?document.location=event.detail.redirecturl:window.location.reload()):Notification.addNotification({type:"error",message:event.detail.errors.join("<br>")})})),form.show()}))}))};_exports.setupModals=function(modals){modals.forEach((function(modaldata){console.log("setupModalsDeprecated, "+modaldata.elementSelector),document.querySelectorAll(modaldata.elementSelector).forEach((function(element){element.addEventListener("click",(function(e){var title=this.getAttribute("data-title")||this.innerHTML,formClass=modaldata.formClass,dataID=this.getAttribute("data-id")||null,dataParentID=this.getAttribute("data-parentid")||null,action=this.getAttribute("data-action")||null,form=new _modalform.default({formClass:formClass,args:{action:action,dataid:dataID,dataparentid:dataParentID},modalConfig:{title:title,large:!0},saveButtonText:title,returnFocus:e.target});form.addEventListener(form.events.FORM_SUBMITTED,(function(event){event.detail.result?(event.detail.returnaction,event.detail.redirecturl?document.location=event.detail.redirecturl:window.location.reload()):Notification.addNotification({type:"error",message:event.detail.errors.join("<br>")})})),form.show()}))}))}))}}));

//# sourceMappingURL=coursegoals.min.js.map